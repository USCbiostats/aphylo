<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistical Inference and Prediction of Annotations in Phylogenetic Trees • aphylo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Statistical Inference and Prediction of Annotations in Phylogenetic Trees">
<meta property="og:description" content="Implements a parsimonious evolutionary model to analyze and predict gene-functional annotations in phylogenetic trees as described in Vega Yon et al. (2021) &lt;doi:10.1371/journal.pcbi.1007948&gt;. Focusing on computational efficiency, aphylo makes it possible to estimate pooled phylogenetic models, including thousands (hundreds) of annotations (trees) in the same run. The package also provides the tools for visualization of annotated phylogenies, calculation of posterior probabilities (prediction) and goodness-of-fit assessment featured in Vega Yon et al. (2021).">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">aphylo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/example.html">Simulation and Inference</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/USCbiostats/aphylo/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level1">
<div class="page-header"><h1 id="aphylo-statistical-inference-of-annotated-phylogenetic-trees-">aphylo: Statistical Inference of Annotated Phylogenetic Trees <img src="reference/figures/logo.svg" align="right" width="180px"><a class="anchor" aria-label="anchor" href="#aphylo-statistical-inference-of-annotated-phylogenetic-trees-"></a>
</h1></div>
<p>The <code>aphylo</code> R package implements estimation and data imputation methods for Functional Annotations in Phylogenetic Trees. The core function consists of the log-likelihood computation of observing a given phylogenetic tree with functional annotation on its leaves and the probabilities associated to gain and loss of function, including probabilities of experimental misclassification. The log-likelihood is computed using peeling algorithms, which required developing and implementing efficient algorithms for re-coding and preparing phylogenetic tree data to be used with the package. Finally, <code>aphylo</code> works smoothly with popular tools for analysis of phylogenetic data such as <code>ape</code> R package, “Analyses of Phylogenetics and Evolution.”</p>
<p>The package is under MIT License and is developed by the Computing and Software Cores of the Biostatistics Division’s NIH Project Grant (P01) at the Department of Preventive Medicine at the University of Southern California.</p>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"aphylo"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>When using aphylo, please cite the following paper<span class="sc">:</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  Vega Yon GG, Thomas DC, Morrison J, Mi H, Thomas PD, et <span class="fu">al.</span> (<span class="dv">2021</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  Bayesian parameter estimation <span class="cf">for</span> automatic annotation of gene</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  functions using observational data and phylogenetic trees. PLOS</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  Computational Biology <span class="dv">17</span>(<span class="dv">2</span>)<span class="sc">:</span> e1007948.</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  https<span class="sc">:</span><span class="er">//</span>doi.org<span class="sc">/</span><span class="fl">10.1371</span><span class="sc">/</span>journal.pcbi<span class="fl">.1007948</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>And the actual R package<span class="sc">:</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  Vega Yon <span class="fu">G</span> (????). _Statistical Inference of Annotated Phylogenetic</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  Trees_. R package version <span class="fl">0.3</span><span class="dv">-5</span>,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="sc">&lt;</span>https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>USCBiostats<span class="sc">/</span>aphylo<span class="sc">&gt;</span>.</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>To see these entries <span class="cf">in</span> BibTeX format, use <span class="st">'print(&lt;citation&gt;,</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="st">bibtex=TRUE)'</span>, <span class="st">'toBibtex(.)'</span>, or set</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="st">'options(citation.bibtex.max=999)'</span>.</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="install">Install<a class="anchor" aria-label="anchor" href="#install"></a>
</h2>
<p>This package depends on another on-development R package, the <a href="https://github.com/USCbiostats/fmcmc" class="external-link"><code>fmcmc</code></a>. So first, you need to install it:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"USCbiostats/fmcmc"</span><span class="op">)</span></span></code></pre></div>
<p>Then you can install the <code>aphylo</code> package</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"USCbiostats/aphylo"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reading-data">Reading data<a class="anchor" aria-label="anchor" href="#reading-data"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/USCbiostats/aphylo" class="external-link">aphylo</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>Loading required package<span class="sc">:</span> ape</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This datasets are included in the package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fakeexperiment"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"faketree"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fakeexperiment</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>     LeafId f1 f2</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>[<span class="dv">1</span>,]      <span class="dv">1</span>  <span class="dv">0</span>  <span class="dv">0</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>[<span class="dv">2</span>,]      <span class="dv">2</span>  <span class="dv">0</span>  <span class="dv">1</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>[<span class="dv">3</span>,]      <span class="dv">3</span>  <span class="dv">1</span>  <span class="dv">0</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>[<span class="dv">4</span>,]      <span class="dv">4</span>  <span class="dv">1</span>  <span class="dv">1</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">faketree</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>     ParentId NodeId</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>[<span class="dv">1</span>,]        <span class="dv">6</span>      <span class="dv">1</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>[<span class="dv">2</span>,]        <span class="dv">6</span>      <span class="dv">2</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>[<span class="dv">3</span>,]        <span class="dv">7</span>      <span class="dv">3</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>[<span class="dv">4</span>,]        <span class="dv">7</span>      <span class="dv">4</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>[<span class="dv">5</span>,]        <span class="dv">5</span>      <span class="dv">6</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>[<span class="dv">6</span>,]        <span class="dv">5</span>      <span class="dv">7</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">O</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/aphylo-class.html">new_aphylo</a></span><span class="op">(</span></span>
<span>  tip.annotation <span class="op">=</span> <span class="va">fakeexperiment</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  tree           <span class="op">=</span> <span class="fu"><a href="reference/as.phylo.html">as.phylo</a></span><span class="op">(</span><span class="va">faketree</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">O</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>Phylogenetic tree with <span class="dv">4</span> tips and <span class="dv">3</span> internal nodes.</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>Tip labels<span class="sc">:</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>Node labels<span class="sc">:</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>Rooted; no branch length.</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a> <span class="fu">Tip</span> (leafs) annotations<span class="sc">:</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  f1 f2</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">0</span>  <span class="dv">0</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">0</span>  <span class="dv">1</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">1</span>  <span class="dv">0</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">1</span>  <span class="dv">1</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a> Internal node annotations<span class="sc">:</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  f1 f2</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">9</span>  <span class="dv">9</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">9</span>  <span class="dv">9</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">9</span>  <span class="dv">9</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/as.phylo.html">as.phylo</a></span><span class="op">(</span><span class="va">O</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>Phylogenetic tree with <span class="dv">4</span> tips and <span class="dv">3</span> internal nodes.</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>Tip labels<span class="sc">:</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>Node labels<span class="sc">:</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>Rooted; no branch length.</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We can visualize it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">O</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/get-offspring-1.png"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_logLik.html">plot_logLik</a></span><span class="op">(</span><span class="va">O</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/get-offspring-2.png"></p>
</div>
<div class="section level2">
<h2 id="simulating-annotated-trees">Simulating annotated trees<a class="anchor" aria-label="anchor" href="#simulating-annotated-trees"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">198</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/raphylo.html">raphylo</a></span><span class="op">(</span></span>
<span>  <span class="fl">50</span>,</span>
<span>  P    <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  psi  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  mu_d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  mu_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  Pi   <span class="op">=</span> <span class="fl">.4</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>Phylogenetic tree with <span class="dv">50</span> tips and <span class="dv">49</span> internal nodes.</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>Tip labels<span class="sc">:</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, ...</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>Node labels<span class="sc">:</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">55</span>, <span class="dv">56</span>, ...</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>Rooted; no branch length.</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a> <span class="fu">Tip</span> (leafs) annotations<span class="sc">:</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  fun0000</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">1</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="dv">2</span>       <span class="dv">0</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="dv">3</span>       <span class="dv">0</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="dv">4</span>       <span class="dv">1</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="dv">5</span>       <span class="dv">0</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="dv">6</span>       <span class="dv">0</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="fu">...</span>(<span class="dv">44</span> obs. omitted)...</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a> Internal node annotations<span class="sc">:</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>  fun0000</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">1</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="dv">2</span>       <span class="dv">1</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="dv">3</span>       <span class="dv">1</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="dv">4</span>       <span class="dv">1</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="dv">5</span>       <span class="dv">1</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="dv">6</span>       <span class="dv">0</span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="fu">...</span>(<span class="dv">43</span> obs. omitted)...</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="likelihood">Likelihood<a class="anchor" aria-label="anchor" href="#likelihood"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameters and data</span></span>
<span><span class="va">psi</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.020</span>,<span class="fl">0.010</span><span class="op">)</span></span>
<span><span class="va">mu_d</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>,<span class="fl">.10</span><span class="op">)</span></span>
<span><span class="va">mu_s</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>,<span class="fl">.01</span><span class="op">)</span></span>
<span><span class="va">eta</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">.9</span><span class="op">)</span></span>
<span><span class="va">pi_root</span> <span class="op">&lt;-</span> <span class="fl">.05</span></span>
<span></span>
<span><span class="co"># Computing likelihood</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="reference/LogLike.html">LogLike</a></span><span class="op">(</span><span class="va">dat</span>, psi <span class="op">=</span> <span class="va">psi</span>, mu_d <span class="op">=</span> <span class="va">mu_d</span>, mu_s <span class="op">=</span> <span class="va">mu_s</span>, eta <span class="op">=</span> <span class="va">eta</span>, Pi <span class="op">=</span> <span class="va">pi_root</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>List of <span class="dv">2</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a> <span class="sc">$</span> Pr<span class="sc">:</span>List of <span class="dv">1</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  ..<span class="sc">$</span> <span class="er">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="fl">0.018</span> <span class="fl">0.686</span> <span class="fl">0.686</span> <span class="fl">0.018</span> <span class="fl">0.686</span> <span class="fl">0.686</span> <span class="fl">0.018</span> <span class="fl">0.018</span> <span class="fl">0.018</span> <span class="fl">0.686</span> ...</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a> <span class="sc">$</span> ll<span class="sc">:</span> num <span class="sc">-</span><span class="fl">40.4</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h1>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using L-BFGS-B (MLE) to get an initial guess</span></span>
<span><span class="va">ans0</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/aphylo_mle.html">aphylo_mle</a></span><span class="op">(</span><span class="va">dat</span> <span class="op">~</span> <span class="va">psi</span> <span class="op">+</span> <span class="va">mu_d</span> <span class="op">+</span> <span class="va">Pi</span> <span class="op">+</span> <span class="va">eta</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># MCMC method</span></span>
<span><span class="va">ans2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/aphylo_mcmc.html">aphylo_mcmc</a></span><span class="op">(</span></span>
<span>  <span class="va">dat</span> <span class="op">~</span> <span class="va">mu_d</span> <span class="op">+</span> <span class="va">mu_s</span> <span class="op">+</span> <span class="va">Pi</span>,</span>
<span>  prior   <span class="op">=</span> <span class="fu"><a href="reference/bprior.html">bprior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">9</span>, <span class="fl">9</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nsteps<span class="op">=</span><span class="fl">5e3</span>, burnin<span class="op">=</span><span class="fl">500</span>, thin<span class="op">=</span><span class="fl">10</span>, nchains<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>Warning<span class="sc">:</span> While using multiple chains, a single initial point has been passed</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>via <span class="st">`</span><span class="at">initial</span><span class="st">`</span><span class="sc">:</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span>). The values will be recycled.</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>Ideally you would want to start each chain from different locations.</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>Convergence has been reached with <span class="dv">5500</span> steps. Gelman<span class="sc">-</span>Rubin<span class="st">'s R: 1.0097. (500 final count of samples).</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans2</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>ESTIMATION OF ANNOTATED PHYLOGENETIC TREE</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a> Call<span class="sc">:</span> <span class="fu">aphylo_mcmc</span>(<span class="at">model =</span> dat <span class="sc">~</span> mu_d <span class="sc">+</span> mu_s <span class="sc">+</span> Pi, <span class="at">priors =</span> <span class="fu">bprior</span>(<span class="fu">c</span>(<span class="dv">9</span>, </span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">5</span>)), <span class="at">control =</span> <span class="fu">list</span>(<span class="at">nsteps =</span> <span class="dv">5000</span>, </span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>    <span class="at">burnin =</span> <span class="dv">500</span>, <span class="at">thin =</span> <span class="dv">10</span>, <span class="at">nchains =</span> <span class="dv">2</span>))</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a> <span class="fu">LogLik</span> (unnormalized)<span class="sc">:</span> <span class="sc">-</span><span class="fl">20.1333</span> </span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a> Method used<span class="sc">:</span> <span class="fu">mcmc</span> (<span class="dv">5500</span> steps)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a> <span class="co"># of Leafs: 50</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a> <span class="co"># of Functions 1</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a> <span class="co"># of Trees: 1</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>         Estimate  Std. Err.</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a> mu_d0   <span class="fl">0.9107</span>    <span class="fl">0.0797</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a> mu_d1   <span class="fl">0.1648</span>    <span class="fl">0.0800</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a> mu_s0   <span class="fl">0.1157</span>    <span class="fl">0.0735</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a> mu_s1   <span class="fl">0.1001</span>    <span class="fl">0.0442</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a> Pi      <span class="fl">0.5329</span>    <span class="fl">0.1450</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">ans2</span>,</span>
<span>  nsample <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  loo     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncores  <span class="op">=</span> <span class="fl">2L</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/MLE-1.png"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MCMC Diagnostics with coda</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">coda</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/gelman.diag.html" class="external-link">gelman.diag</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">$</span><span class="va">hist</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>Potential scale reduction factors<span class="sc">:</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>      Point est. Upper C.I.</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>mu_d0       <span class="fl">1.01</span>       <span class="fl">1.05</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>mu_d1       <span class="fl">1.00</span>       <span class="fl">1.00</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>mu_s0       <span class="fl">1.00</span>       <span class="fl">1.02</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>mu_s1       <span class="fl">1.01</span>       <span class="fl">1.02</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>Pi          <span class="fl">1.00</span>       <span class="fl">1.00</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>Multivariate psrf</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="fl">1.01</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">$</span><span class="va">hist</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/MCMC-1.png"></p>
<p><img src="reference/figures/MCMC-2.png"></p>
</div>
<div class="section level1">
<h1 id="prediction">Prediction<a class="anchor" aria-label="anchor" href="#prediction"></a>
</h1>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prediction_score.html">prediction_score</a></span><span class="op">(</span><span class="va">ans2</span>, loo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pred</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>Prediction <span class="fu">score</span> (H0<span class="sc">:</span> <span class="at">Observed =</span> Random)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a> N obs.      <span class="sc">:</span> <span class="dv">99</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a> <span class="fu">alpha</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">:</span> <span class="fl">0.26</span>, <span class="fl">0.74</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a> Observed    <span class="sc">:</span> <span class="fl">0.71</span> </span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a> Random      <span class="sc">:</span> <span class="fl">0.62</span> </span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a> <span class="fu">P</span>(<span class="sc">&lt;</span>t)       <span class="sc">:</span> <span class="fl">0.1121</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>Values scaled to range between <span class="dv">0</span> and <span class="dv">1</span>, <span class="dv">1</span> being best.</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>Significance levels<span class="sc">:</span> <span class="er">***</span> p <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="sc">**</span> p <span class="sc">&lt;</span> .<span class="dv">05</span>, <span class="sc">*</span> p <span class="sc">&lt;</span> .<span class="dv">10</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>AUC <span class="dv">0</span>.<span class="fl">79.</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>MAE <span class="dv">0</span>.<span class="fl">29.</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/Predict-1.png"></p>
</div>
<div class="section level1">
<h1 id="misc">Misc<a class="anchor" aria-label="anchor" href="#misc"></a>
</h1>
<p>During the development process, we decided to allow the user to choose what ‘tree-reader’ function he would use, particularly between using either the <strong>rncl</strong> R package or ape. For such, we created a short benchmark that compares both functions <a href="playground/ape_now_supports_singletons.html">here</a>.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=aphylo" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/USCbiostats/aphylo/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/USCbiostats/aphylo/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing aphylo</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>George Vega Yon <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3171-0844" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>National
         Cancer Institute (NCI) <br><small class="roles"> Funder </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/USCbiostats/aphylo/actions/workflows/ci.yml" class="external-link"><img src="https://github.com/USCbiostats/aphylo/actions/workflows/ci.yml/badge.svg" alt="R CI"></a></li>
<li><a href="https://codecov.io/gh/USCbiostats/aphylo" class="external-link"><img src="https://codecov.io/gh/USCbiostats/aphylo/branch/master/graph/badge.svg" alt="Coverage Status"></a></li>
<li><a href="https://image.usc.edu" class="external-link"><img src="https://raw.githubusercontent.com/USCbiostats/badges/master/tommy-image-badge.svg" alt="Integrative Methods of Analysis for Genetic Epidemiology"></a></li>
<li><a href="https://CRAN.R-project.org/package=aphylo" class="external-link"><img src="https://www.r-pkg.org/badges/version/aphylo" alt="CRAN status"></a></li>
<li><a href="https://CRAN.R-project.org/package=aphylo" class="external-link"><img src="https://tinyverse.netlify.com/badge/aphylo" alt="status"></a></li>
<li><a href="https://cran.r-project.org/package=aphylo" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/aphylo" alt="CRAN downloads"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by George Vega Yon, National Cancer Institute (NCI).</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>

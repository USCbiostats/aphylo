<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Accuracy calculation as defined in Engelhardt et al. (2011) — accuracy_sifter • aphylo</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Accuracy calculation as defined in Engelhardt et al. (2011) — accuracy_sifter"><meta property="og:description" content="Uses SIFTER's 2011 definition of accuracy, where a protein is tagged as
accurately predicted if the highest ranked prediction matches it."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aphylo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/example.html">Simulation and Inference</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/USCbiostats/aphylo/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Accuracy calculation as defined in Engelhardt et al. (2011)</h1>
    <small class="dont-index">Source: <a href="https://github.com/USCbiostats/aphylo/blob/HEAD/R/accuracy_sifter.R" class="external-link"><code>R/accuracy_sifter.R</code></a></small>
    <div class="hidden name"><code>accuracy_sifter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Uses SIFTER's 2011 definition of accuracy, where a protein is tagged as
accurately predicted if the highest ranked prediction matches it.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">accuracy_sifter</span><span class="op">(</span><span class="va">pred</span>, <span class="va">lab</span>, tol <span class="op">=</span> <span class="fl">1e-10</span>, highlight <span class="op">=</span> <span class="st">""</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for aphylo_estimates</span>
<span class="fu">accuracy_sifter</span><span class="op">(</span><span class="va">pred</span>, <span class="va">lab</span>, tol <span class="op">=</span> <span class="fl">1e-10</span>, highlight <span class="op">=</span> <span class="st">""</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">accuracy_sifter</span><span class="op">(</span><span class="va">pred</span>, <span class="va">lab</span>, tol <span class="op">=</span> <span class="fl">1e-10</span>, highlight <span class="op">=</span> <span class="st">""</span>, nine_na <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pred</dt>
<dd><p>A matrix of predictions, or an <a href="aphylo_estimates.html">aphylo_estimates</a> object.</p></dd>
<dt>lab</dt>
<dd><p>A matrix of labels (0,1,NA, or 9 if <code>nine_na = TRUE</code>).</p></dd>
<dt>tol</dt>
<dd><p>Numeric scalar. Predictions within <code>tol</code> of the max score
will be tagged as the prediction made by the model (see deails).</p></dd>
<dt>highlight</dt>
<dd><p>Pattern passed to <a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a> used to highlight
predicted functions that match the observed.</p></dd>
<dt>...</dt>
<dd><p>Further arguments passed to the method. In the case of <code>aphylo_estimates</code>,
the arguments are passed to <code><a href="posterior-probabilities.html">predict.aphylo_estimates()</a></code>.</p></dd>
<dt>nine_na</dt>
<dd><p>Treat 9 as NA.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame with <code><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip()</a></code> rows and four variables. The variables are:</p><ul><li><p>Gene: Label of the gene</p></li>
<li><p>Predicted: The assigned gene function.</p></li>
<li><p>Observed: The true set of gene functions.</p></li>
<li><p>Accuracy: The measurement of accuracy according to Engelhardt et al. (2011).</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The analysis is done at the protein level. For each protein, the function
compares the YES annotations of that proteins with the predicted by the model.
The algorithm selects the predicted annotations as those that are within
<code>tol</code> of the maximum score.</p>
<p>This algorithm doesn't take into account NOT annotations (0s), which are
excluded from the analysis.</p>
<p>When <code>highlight = ""</code>, no highlight is done.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">81231</span><span class="op">)</span></span>
<span class="r-in"><span class="va">atree</span> <span class="op">&lt;-</span> <span class="fu"><a href="raphylo.html">raphylo</a></span><span class="op">(</span><span class="fl">50</span>, psi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, P <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="aphylo_mcmc.html">aphylo_mcmc</a></span><span class="op">(</span><span class="va">atree</span> <span class="op">~</span> <span class="va">mu_d</span> <span class="op">+</span> <span class="va">mu_s</span> <span class="op">+</span> <span class="va">Pi</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>While using multiple chains, a single initial point has been passed via `initial`: c(0.9, 0.5, 0.1, 0.05, 0.5). The values will be recycled. Ideally you would want to start each chain from different locations.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Convergence has been reached with 10000 steps. Gelman-Rubin's R: 1.0134. (500 final count of samples).</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">accuracy_sifter</span><span class="op">(</span><span class="va">ans</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Gene Predicted                Observed Accuracy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1   fun0001 fun0000,fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2   fun0001         fun0000,fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4   fun0002         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7   fun0002         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8   fun0001         fun0000,fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9   fun0002         fun0000,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10   fun0001         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   11   fun0002         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   12   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   13   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   14   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   15   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   16   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   17   fun0001         fun0000,fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   18   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   19   fun0002         fun0000,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   20   fun0001 fun0000,fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21   21   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   22   fun0001         fun0000,fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23   23   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24   24   fun0002         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   25   fun0002         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   26   fun0000         fun0000,fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   27   fun0002 fun0000,fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28   28   fun0002         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   29   fun0002 fun0000,fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   30   fun0000 fun0000,fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31   31   fun0002 fun0000,fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32   32   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33   33   fun0002         fun0000,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34   34   fun0001                 fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35   35   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36   36   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37   37   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38   38   fun0002         fun0000,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39   39   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40   40   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41   41   fun0001         fun0000,fun0002        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42   42   fun0001         fun0000,fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43   43   fun0002                 fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   44   fun0001                 fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45   45   fun0000         fun0000,fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46   46   fun0001         fun0000,fun0001        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47   47   fun0002         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48   48   fun0002 fun0000,fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49   49   fun0002         fun0001,fun0002        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50   50   fun0002                 fun0002        1</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by George Vega Yon, National Cancer Institute (NCI).</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

